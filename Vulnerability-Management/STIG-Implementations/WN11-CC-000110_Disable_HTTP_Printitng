<#
.SYNOPSIS
    This PowerShell script sets a policy registry value to disable printing over HTTP.

.NOTES
    Author          : Julian Smith
    LinkedIn        : linkedin.com/in/jsmithsec/
    GitHub          : github.com/jsmithdefense
    Date Created    : 2026-02-21
    Last Modified   : 2026-02-22
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : 21156
    STIG-ID         : WN11-CC-000110

.TESTED ON
    Date(s) Tested  : 2026-02-21; 2026-02-22
    Tested By       : Julian Smith
    Systems Tested  : vuln-machine
    PowerShell Ver. : 7

.USAGE

> Run "Computer Management".
> Navigate to System Tools >> Local Users and Groups >> Users.
> Double-click each active account.
> If "Password never expires" is selected for any account, this is a finding
> Run the following command

    Example syntax:
    PS C:\> .\STIG-ID-WN11-AU-000090.ps1
#>

# set DisableHTTPPrinting value to 1
New-Item -Path "HKLM:\Software\Policies\Microsoft\Windows NT\Printers" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\Software\Policies\Microsoft\Windows NT\Printers" -Name "DisableHTTPPrinting" -Type DWord -Value 1

# validate 
Get-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\Printers" -Name DisableHTTPPrinting

