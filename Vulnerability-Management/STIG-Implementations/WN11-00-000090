<#
.SYNOPSIS
    This PowerShell script Uses auditpol to enable Process Creation success auditing in Windows advanced audit policy settings.

.NOTES
    Author          : Julian Smith
    LinkedIn        : linkedin.com/in/jsmithsec/
    GitHub          : github.com/jsmithdefense
    Date Created    : 2026-02-21
    Last Modified   : 2026-02-21
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : 21156
    STIG-ID         : WN11-00-000090

.TESTED ON
    Date(s) Tested  : 2026-02-20
    Tested By       : Julian Smith
    Systems Tested  : vuln-machine
    PowerShell Ver. : 7

.USAGE

Use the AuditPol tool to review the current Audit Policy configuration:
Open a Command Prompt with elevated privileges ("Run as Administrator").
Enter "AuditPol /get /category:*".

Compare the AuditPol settings with the following. If the system does not audit the following, this is a finding:

Detailed Tracking >> Process Creation - Success

    Example syntax:
    PS C:\> .\remediation_template(STIG-ID-WN10-AU-000500).ps1 
#>

# Force Advanced Audit Policy to be used
reg add "HKLM\System\CurrentControlSet\Control\Lsa" /v SCENoApplyLegacyAuditPolicy /t REG_DWORD /d 1 /f

# Enable Process Creation auditing (Success)
auditpol /set /subcategory:"Process Creation" /success:enable
