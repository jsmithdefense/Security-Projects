<#
.SYNOPSIS
    This PowerShell script disables autorun commands to prevent malicious code execution..
.NOTES
    Author          : Julian Smith
    LinkedIn        : linkedin.com/in/jsmithsec/
    GitHub          : github.com/jsmithdefense
    Date Created    : 2026-02-23
    Last Modified   : 2026-02-23
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : 21156
    STIG-ID         : WN11-CC-000185

.TESTED ON
    Date(s) Tested  : 2026-02-23;
    Tested By       : Julian Smith
    Systems Tested  : vuln-machine
    PowerShell Ver. : 7

.USAGE
    Example syntax:
    PS C:\> .\STIG-CC-WN11-CC-000185.ps1
#>

$regPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer"
if (!(Test-Path $regPath)) { New-Item -Path $regPath -Force }
Set-ItemProperty -Path $regPath -Name "NoAutorun" -Value 1 -Type DWord
gpupdate /force
